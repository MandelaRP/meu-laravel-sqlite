import{r as x,S as P}from"./Primitive-BrnKrBYL.js";import{r as M,w as g,p as _,x as b,k as O,z as C,O as k,N as D,L as w,a8 as L,a2 as $,U as F,ah as j}from"./app-rxSkm_8n.js";import{g as z,i as q,f as B}from"./index-CNtfqitb.js";import{a as R}from"./VisuallyHidden-BSu4F0qb.js";function X(){let n=document.activeElement;if(n==null)return null;for(;n!=null&&n.shadowRoot!=null&&n.shadowRoot.activeElement!=null;)n=n.shadowRoot.activeElement;return n}function V(n,t){const u=M(n);function c(m){return t[u.value][m]??u.value}return{state:u,dispatch:m=>{u.value=c(m)}}}function K(n,t){var h;const u=M({}),c=M("none"),r=M(n),m=n.value?"mounted":"unmounted";let f;const s=((h=t.value)==null?void 0:h.ownerDocument.defaultView)??z,{state:v,dispatch:l}=V(m,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}}),a=i=>{var o;if(q){const N=new CustomEvent(i,{bubbles:!1,cancelable:!1});(o=t.value)==null||o.dispatchEvent(N)}};g(n,async(i,o)=>{var T;const N=o!==i;if(await _(),N){const S=c.value,E=I(t.value);i?(l("MOUNT"),a("enter"),E==="none"&&a("after-enter")):E==="none"||E==="undefined"||((T=u.value)==null?void 0:T.display)==="none"?(l("UNMOUNT"),a("leave"),a("after-leave")):o&&S!==E?(l("ANIMATION_OUT"),a("leave")):(l("UNMOUNT"),a("after-leave"))}},{immediate:!0});const e=i=>{const o=I(t.value),N=o.includes(i.animationName),T=v.value==="mounted"?"enter":"leave";if(i.target===t.value&&N&&(a(`after-${T}`),l("ANIMATION_END"),!r.value)){const S=t.value.style.animationFillMode;t.value.style.animationFillMode="forwards",f=s==null?void 0:s.setTimeout(()=>{var E;((E=t.value)==null?void 0:E.style.animationFillMode)==="forwards"&&(t.value.style.animationFillMode=S)})}i.target===t.value&&o==="none"&&l("ANIMATION_END")},p=i=>{i.target===t.value&&(c.value=I(t.value))},A=g(t,(i,o)=>{i?(u.value=getComputedStyle(i),i.addEventListener("animationstart",p),i.addEventListener("animationcancel",e),i.addEventListener("animationend",e)):(l("ANIMATION_END"),f!==void 0&&(s==null||s.clearTimeout(f)),o==null||o.removeEventListener("animationstart",p),o==null||o.removeEventListener("animationcancel",e),o==null||o.removeEventListener("animationend",e))},{immediate:!0}),d=g(v,()=>{const i=I(t.value);c.value=v.value==="mounted"?i:"none"});return b(()=>{A(),d()}),{isPresent:O(()=>["mounted","unmountSuspended"].includes(v.value))}}function I(n){return n&&getComputedStyle(n).animationName||"none"}var Z=C({name:"Presence",props:{present:{type:Boolean,required:!0},forceMount:{type:Boolean}},slots:{},setup(n,{slots:t,expose:u}){var l;const{present:c,forceMount:r}=k(n),m=M(),{isPresent:f}=K(c,m);u({present:f});let s=t.default({present:f.value});s=x(s||[]);const v=D();if(s&&(s==null?void 0:s.length)>1){const a=(l=v==null?void 0:v.parent)!=null&&l.type.name?`<${v.parent.type.name} />`:"component";throw new Error([`Detected an invalid children for \`${a}\` for  \`Presence\` component.`,"","Note: Presence works similarly to `v-if` directly, but it waits for animation/transition to finished before unmounting. So it expect only one direct child of valid VNode type.","You can apply a few solutions:",["Provide a single child element so that `presence` directive attach correctly.","Ensure the first child is an actual element instead of a raw text node or comment node."].map(e=>`  - ${e}`).join(`
`)].join(`
`))}return()=>r.value||c.value||f.value?w(t.default({present:f.value})[0],{ref:a=>{const e=B(a);return typeof(e==null?void 0:e.hasAttribute)>"u"||(e!=null&&e.hasAttribute("data-reka-popper-content-wrapper")?m.value=e.firstElementChild:m.value=e),e}}):null}});const U="data-reka-collection-item";function W(n={}){const{key:t="",isProvider:u=!1}=n,c=`${t}CollectionProvider`;let r;if(u){const a=M(new Map);r={collectionRef:M(),itemMap:a},L(c,r)}else r=$(c);const m=(a=!1)=>{const e=r.collectionRef.value;if(!e)return[];const p=Array.from(e.querySelectorAll(`[${U}]`)),d=Array.from(r.itemMap.value.values()).sort((y,h)=>p.indexOf(y.ref)-p.indexOf(h.ref));return a?d:d.filter(y=>y.ref.dataset.disabled!=="")},f=C({name:"CollectionSlot",setup(a,{slots:e}){const{primitiveElement:p,currentElement:A}=R();return g(A,()=>{r.collectionRef.value=A.value}),()=>w(P,{ref:p},e)}}),s=C({name:"CollectionItem",inheritAttrs:!1,props:{value:{validator:()=>!0}},setup(a,{slots:e,attrs:p}){const{primitiveElement:A,currentElement:d}=R();return F(y=>{if(d.value){const h=j(d.value);r.itemMap.value.set(h,{ref:d.value,value:a.value}),y(()=>r.itemMap.value.delete(h))}}),()=>w(P,{...p,[U]:"",ref:A},e)}}),v=O(()=>Array.from(r.itemMap.value.values())),l=O(()=>r.itemMap.value.size);return{getItems:m,reactiveItems:v,itemMapSize:l,CollectionSlot:f,CollectionItem:s}}export{Z as P,X as g,W as u};
